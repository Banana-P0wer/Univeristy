<- [[8.1.4.6]] 
# **Разработка схемы IP-адресации**
*(Полный разбор всех заданий, решений, команд и возможных вопросов преподавателя)*  

---

# **📌 ЧАСТЬ 1: Разработка схемы IP-адресации**

## **🔹 Шаг 1: Разбейте сеть 192.168.100.0/24 на нужное количество подсетей**
В этом шаге мы **должны разделить сеть** на подсети, которые соответствуют **топологии сети**.

### **A. Сколько потребуется подсетей в соответствии с имеющейся топологией?**  
В топологии **4 локальные сети (LAN) и 1 WAN-сеть**, что требует **5 подсетей**:
1. **LAN 1** (Подключены PC1, S1, R1)
2. **LAN 2** (Подключены PC2, S2, R1)
3. **LAN 3** (Подключены PC3, S3, R2)
4. **LAN 4** (Подключены PC4, S4, R2)
5. **WAN-сеть** (Связь между R1 и R2)

### **B. Сколько бит необходимо заимствовать для поддержки нескольких подсетей?**  
Мы начинаем с сети **192.168.100.0/24** (255.255.255.0), где **24 бита** определяют сеть, а **8 бит** остаётся для узлов.  

Чтобы создать подсети, нам нужно **забрать биты у узлов**.  

#### **Расчёт для LAN (подключение ПК и коммутаторов)**  
- В каждой **LAN-сети нужно минимум 25 IP-адресов**.  
- Формула расчёта рабочих IP в подсети:
  2^h - 2
  (где **h** — количество бит, оставшихся для узлов).  
- Нам **нужно минимум 25 узлов**, берём ближайшую степень двойки:  
  - **2⁵ = 32** (доступно **30 узлов**, подходит).  
  - Значит, **5 бит остаётся для узлов**, а **3 бита берём для подсетей**.  
  - Новая маска: **/27** (255.255.255.224).  

#### **Расчёт для WAN (связь R1 ↔ R2)**  
- Нужно **2 IP (1 для R1, 1 для R2)**.  
- **2² = 4** (2 рабочих IP, подходит).  
- Значит, **оставляем 2 бита под узлы**, а **6 бит берём для подсетей**.  
- Новая маска: **/30** (255.255.255.252).  

### **C. Сколько в результате этого создается подсетей?**  
- Мы **заимствовали 3 бита** для LAN.  
- **Число доступных подсетей**:
  \[
  2^3 = 8 \text{ (но используем 5)}
  \]

---

# **📌 ЧАСТЬ 2: Назначение подсетей**
Теперь **применяем расчёты** и раздаём адреса.

| Подсеть  | Сетевой адрес | Маска | Рабочие IP-адреса | Широковещательный |
|----------|--------------|-------|-------------------|------------------|
| **LAN 1** | 192.168.100.0/27 | 255.255.255.224 | 192.168.100.1 - 192.168.100.30 | 192.168.100.31 |
| **LAN 2** | 192.168.100.32/27 | 255.255.255.224 | 192.168.100.33 - 192.168.100.62 | 192.168.100.63 |
| **LAN 3** | 192.168.100.64/27 | 255.255.255.224 | 192.168.100.65 - 192.168.100.94 | 192.168.100.95 |
| **LAN 4** | 192.168.100.96/27 | 255.255.255.224 | 192.168.100.97 - 192.168.100.126 | 192.168.100.127 |
| **WAN** | 192.168.100.128/30 | 255.255.255.252 | 192.168.100.129 - 192.168.100.130 | 192.168.100.131 |

**📌 Почему адреса идут с шагом 32 в LAN?**  
- Маска **/27** (255.255.255.224) → шаг подсетей **32** (`256 - 224 = 32`).  
- Поэтому **адреса увеличиваются на 32** (`0 → 32 → 64 → 96 → 128`).  

---

# **📌 ЧАСТЬ 3: Настройка устройств**
## **🔹 Настройка маршрутизатора R1**
```bash
enable
configure terminal
interface GigabitEthernet 0/0
ip address 192.168.100.1 255.255.255.224
no shutdown
exit
interface GigabitEthernet 0/1
ip address 192.168.100.33 255.255.255.224
no shutdown
exit
interface Serial 0/0/0
ip address 192.168.100.129 255.255.255.252
no shutdown
exit
end
write memory
```

---

## **🔹 Настройка коммутатора S3**
```bash
enable
configure terminal
interface Vlan1
ip address 192.168.100.66 255.255.255.224
no shutdown
exit
ip default-gateway 192.168.100.65
end
write memory
```

---

## **🔹 Настройка ПК PC4**
1. **Открыть PC4 → Desktop → IP Configuration**.
2. Ввести:
   - **IP Address:** `192.168.100.126`
   - **Subnet Mask:** `255.255.255.224`
   - **Default Gateway:** `192.168.100.97`

---

# **📌 ЧАСТЬ 4: Проверка соединений (PING)**
### **📌 Проверка с R1**
```bash
ping 192.168.100.65  # Проверяем связь с R2
ping 192.168.100.66  # Проверяем связь с S3
ping 192.168.100.126 # Проверяем связь с PC4
```

### **📌 Проверка с S3**
```bash
ping 192.168.100.126 # Проверяем связь с PC4
ping 192.168.100.65  # Проверяем связь с R2
```

### **📌 Проверка с PC4**
```bash
ping 192.168.100.97  # Проверяем связь с маршрутизатором R2
ping 192.168.100.1   # Проверяем связь с маршрутизатором R1
ping 192.168.100.66  # Проверяем связь с S3
```

---

# **📌 Каверзные вопросы преподавателя**
### **1️⃣ Почему в WAN-сети маска /30, а не /29?**
- **/30 даёт 2 рабочих IP** (и 2 зарезервированных).  
- **/29 дал бы 6 IP**, но **4 были бы лишними**.

### **2️⃣ Почему адреса в LAN идут с шагом 32?**
- Маска **/27 (255.255.255.224)** → шаг **32** (`256 - 224 = 32`).

### **3️⃣ Почему широковещательный адрес такой?**
- Это **последний адрес** в подсети (все биты узлов = 1).  
  Например, **192.168.100.31 для 192.168.100.0/27**.

### **4️⃣ Что делать, если пинг не проходит?**
1. **Проверить IP и маску** (`show ip interface brief`).
2. **Проверить маршруты** (`show ip route`).
3. **Убедиться, что интерфейсы включены** (`no shutdown`).

[[8.2.1.4]] ->